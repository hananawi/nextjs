---
title: c-source-code-to-excutable
date: 2022-04-25 11:02:14
tags:
---

## Four steps to generate exutable

1. #### Preprocessing

   处理各种预编译指令等，如，`#define ...`, `#include ...`

2. #### Compilation proper

   把 C 源码编译成汇编代码

3. #### Assembly

   把汇编代码编译成目标文件（.o 或.obj）

4. #### Linking
   从一个或多个目标文件中生成最终的可执行文件。

- 在编译步骤中，若编译器发现一个没有定义（definition）的函数等东西，只要编译器能找到那个函数的声明（declaration）（在同一个文件中或者`#include`的头文件中），编译器就不会报错，编译器会认为这个函数的定义在其他的文件中，编译器并不关心这个函数的定义实际上存不存在，因为编译器一次只会查看一个文件的内容。

- 编译器每次编译的一个 C 源文件和其直接或间接 include 的头文件称为一个 translation unit。

- 一个符号（symbol），就是变量名函数名等，可以声明多次，但只能定义一次。

- 在连接过程中，连接器则会去寻找编译过程中没有找到定义的那个函数的定义（去其他目标文件或者静态库或者动态库中寻找），若没有找到则连接器会报错。因此，编译器一般报的错是语法问题，如少了个分号，右括号等；连接器报的错则是缺失定义或着重复定义

- 在连接过程中，若连接器遇到静态库，则整个静态库（.a, .lib）都会被包含在最终生成的可执行程序中；若遇到动态库（.so, .dylib），则最终的程序中只会包含其参照，在执行程序的加载（load）阶段会用到此参照。

5. #### Loading
   扫描程序中的动态库参照，并加载其动态库，使程序准备好运行，然后运行该程序，把控制台的控制权转移给该程序的第一条指令。
   参照 dlopen 函数
   TODO
